/*! For license information please see 447.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[447],{4409:(r,t,n)=>{n.d(t,{A:()=>o});var e=n(4991),s=n.n(e),a=n(6314),i=n.n(a)()(s());i.push([r.id,".pilot-form[data-v-1428465c]{padding:0}.content-header[data-v-1428465c]{padding:15px 0}.card[data-v-1428465c]{border:none;box-shadow:0 0 1px rgba(0,0,0,.125),0 1px 3px rgba(0,0,0,.2)}.form-group label[data-v-1428465c]{font-weight:600}.is-invalid[data-v-1428465c]{border-color:#dc3545}.invalid-feedback[data-v-1428465c]{display:block}","",{version:3,sources:["webpack://./resources/js/components/forms/PilotForm.vue"],names:[],mappings:"AA6cA,6BACA,SACA,CAEA,iCACA,cACA,CAEA,uBACA,WAAA,CACA,4DACA,CAEA,mCACA,eACA,CAEA,6BACA,oBACA,CAEA,mCACA,aACA",sourcesContent:['<template>\r\n    <div class="pilot-form">\r\n        \x3c!-- Header --\x3e\r\n        <div class="content-header">\r\n            <div class="container-fluid">\r\n                <div class="row mb-2">\r\n                    <div class="col-sm-6">\r\n                        <h1 class="m-0">\r\n                            <i class="fas fa-user-ninja mr-2"></i>\r\n                            {{ isEdit ? \'Editar\' : \'Crear\' }} Piloto\r\n                        </h1>\r\n                    </div>\r\n                    <div class="col-sm-6">\r\n                        <ol class="breadcrumb float-sm-right">\r\n                            <li class="breadcrumb-item">\r\n                                <router-link to="/">Inicio</router-link>\r\n                            </li>\r\n                            <li class="breadcrumb-item">\r\n                                <router-link to="/pilotos">Pilotos</router-link>\r\n                            </li>\r\n                            <li class="breadcrumb-item active">\r\n                                {{ isEdit ? \'Editar\' : \'Crear\' }}\r\n                            </li>\r\n                        </ol>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        \x3c!-- Form Content --\x3e\r\n        <section class="content">\r\n            <div class="container-fluid">\r\n                <div class="row">\r\n                    <div class="col-md-8">\r\n                        <div class="card">\r\n                            <div class="card-header">\r\n                                <h3 class="card-title">\r\n                                    {{ isEdit ? \'Editar\' : \'Nuevo\' }} Piloto\r\n                                </h3>\r\n                            </div>\r\n                            \r\n                            <form @submit.prevent="submitForm" class="card-body">\r\n                                <div class="row">\r\n                                    <div class="col-md-6">\r\n                                        <div class="form-group">\r\n                                            <label for="first_name">Nombre *</label>\r\n                                            <input \r\n                                                v-model="form.first_name"\r\n                                                type="text" \r\n                                                id="first_name"\r\n                                                class="form-control"\r\n                                                :class="{ \'is-invalid\': errors.first_name }"\r\n                                                required\r\n                                            >\r\n                                            <div v-if="errors.first_name" class="invalid-feedback">\r\n                                                {{ errors.first_name[0] }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    <div class="col-md-6">\r\n                                        <div class="form-group">\r\n                                            <label for="last_name">Apellidos *</label>\r\n                                            <input \r\n                                                v-model="form.last_name"\r\n                                                type="text" \r\n                                                id="last_name"\r\n                                                class="form-control"\r\n                                                :class="{ \'is-invalid\': errors.last_name }"\r\n                                                required\r\n                                            >\r\n                                            <div v-if="errors.last_name" class="invalid-feedback">\r\n                                                {{ errors.last_name[0] }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class="row">\r\n                                    <div class="col-md-6">\r\n                                        <div class="form-group">\r\n                                            <label for="rut">RUT *</label>\r\n                                            <input \r\n                                                v-model="form.rut"\r\n                                                type="text" \r\n                                                id="rut"\r\n                                                class="form-control"\r\n                                                :class="{ \'is-invalid\': errors.rut || rutError }"\r\n                                                required\r\n                                                @blur="validateRut"\r\n                                                placeholder="Ej: 12.345.678-9"\r\n                                            >\r\n                                            <div v-if="errors.rut" class="invalid-feedback">\r\n                                                {{ errors.rut[0] }}\r\n                                            </div>\r\n                                            <div v-else-if="rutError" class="invalid-feedback">\r\n                                                {{ rutError }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div class="col-md-6">\r\n                                        <div class="form-group">\r\n                                            <label for="age">Edad</label>\r\n                                            <input \r\n                                                v-model="form.age"\r\n                                                type="number" \r\n                                                id="age"\r\n                                                class="form-control"\r\n                                                :class="{ \'is-invalid\': errors.age }"\r\n                                            >\r\n                                            <div v-if="errors.age" class="invalid-feedback">\r\n                                                {{ errors.age[0] }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class="row">\r\n                                    <div class="col-md-6">\r\n                                        <div class="form-group">\r\n                                            <label for="status">Estado</label>\r\n                                            <select \r\n                                                v-model="form.status"\r\n                                                id="status"\r\n                                                class="form-control"\r\n                                                :class="{ \'is-invalid\': errors.status }"\r\n                                            >\r\n                                                <option value="active">Activo</option>\r\n                                                <option value="inactive">Inactivo</option>\r\n                                                <option value="suspended">Suspendido</option>\r\n                                            </select>\r\n                                            <div v-if="errors.status" class="invalid-feedback">\r\n                                                {{ errors.status[0] }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div class="col-md-6">\r\n                                        <div class="form-group">\r\n                                            <label for="club_id">Club</label>\r\n                                            <select \r\n                                                v-model="form.club_id"\r\n                                                id="club_id"\r\n                                                class="form-control"\r\n                                                :class="{ \'is-invalid\': errors.club_id }"\r\n                                            >\r\n                                                <option value="">Seleccionar club...</option>\r\n                                                <option v-for="club in clubs" :key="club.id" :value="club.id">\r\n                                                    {{ club.name }}\r\n                                                </option>\r\n                                            </select>\r\n                                            <div v-if="errors.club_id" class="invalid-feedback">\r\n                                                {{ errors.club_id[0] }}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class="form-group">\r\n                                    <label for="photo">Foto del Piloto</label>\r\n                                    <input \r\n                                        @change="handleFileUpload"\r\n                                        type="file" \r\n                                        id="photo"\r\n                                        class="form-control-file"\r\n                                        accept="image/*"\r\n                                    >\r\n                                    <small class="form-text text-muted">\r\n                                        Formatos permitidos: JPG, PNG, GIF. Tamaño máximo: 2MB\r\n                                    </small>\r\n                                </div>\r\n\r\n                                <div class="form-group">\r\n                                    <div class="d-flex justify-content-between">\r\n                                        <router-link to="/pilotos" class="btn btn-secondary">\r\n                                            <i class="fas fa-arrow-left mr-1"></i>\r\n                                            Volver\r\n                                        </router-link>\r\n                                        \r\n                                        <button \r\n                                            type="submit" \r\n                                            class="btn btn-primary"\r\n                                            :disabled="loading"\r\n                                        >\r\n                                            <i v-if="loading" class="fas fa-spinner fa-spin mr-1"></i>\r\n                                            <i v-else class="fas fa-save mr-1"></i>\r\n                                            {{ isEdit ? \'Actualizar\' : \'Crear\' }} Piloto\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n\r\n                    \x3c!-- Preview --\x3e\r\n                    <div class="col-md-4">\r\n                        <div class="card">\r\n                            <div class="card-header">\r\n                                <h3 class="card-title">Vista Previa</h3>\r\n                            </div>\r\n                            <div class="card-body text-center">\r\n                                <div class="mb-3">\r\n                                    <img \r\n                                        v-if="form.photo_preview" \r\n                                        :src="form.photo_preview" \r\n                                        alt="Vista previa"\r\n                                        class="img-fluid rounded-circle"\r\n                                        style="width: 120px; height: 120px; object-fit: cover;"\r\n                                    >\r\n                                    <div \r\n                                        v-else\r\n                                        class="bg-secondary rounded-circle d-inline-flex align-items-center justify-content-center" \r\n                                        style="width: 120px; height: 120px;"\r\n                                    >\r\n                                        <i class="fas fa-user fa-3x text-white"></i>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <h4>{{ form.first_name || \'Nombre\' }} {{ form.last_name || \'Apellidos\' }}</h4>\r\n                                <p class="text-muted">Edad: {{ form.age || \'No especificada\' }}</p>\r\n                                \r\n                                <span :class="getStatusClass(form.status)">\r\n                                    {{ getStatusLabel(form.status) }}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: \'PilotForm\',\r\n    data() {\r\n        return {\r\n            loading: false,\r\n            clubs: [],\r\n            form: {\r\n                first_name: \'\',\r\n                last_name: \'\',\r\n                rut: \'\',\r\n                age: \'\',\r\n                status: \'active\',\r\n                club_id: \'\',\r\n                photo: null,\r\n                photo_preview: null\r\n            },\r\n            errors: {},\r\n            rutError: \'\'\r\n        };\r\n    },\r\n    computed: {\r\n        isEdit() {\r\n            return !!this.$route.params.id;\r\n        },\r\n        pilotId() {\r\n            return this.$route.params.id;\r\n        }\r\n    },\r\n    async mounted() {\r\n        await this.loadFormData();\r\n        if (this.isEdit) {\r\n            await this.loadPilot();\r\n        }\r\n    },\r\n    methods: {\r\n        async loadFormData() {\r\n            try {\r\n                const [clubsResponse] = await Promise.all([\r\n                    fetch(\'/api/clubs\')\r\n                ]);\r\n\r\n                if (clubsResponse.ok) {\r\n                    const clubsData = await clubsResponse.json();\r\n                    this.clubs = clubsData.data || clubsData;\r\n                } \r\n            } catch (error) {\r\n                console.error(\'Error loading form data:\', error);\r\n            }\r\n        },\r\n\r\n        async loadPilot() {\r\n            try {\r\n                this.loading = true;\r\n                const response = await fetch(`/api/pilots/${this.pilotId}`);\r\n                \r\n                if (response.ok) {\r\n                    const data = await response.json();\r\n                    const pilot = data.data || data;\r\n                    \r\n                    this.form = {\r\n                        first_name: pilot.first_name || \'\',\r\n                        last_name: pilot.last_name || \'\',\r\n                        age: pilot.age || \'\',\r\n                        status: pilot.status || \'active\',\r\n                        club_id: pilot.club_id || \'\',\r\n                        photo: null,\r\n                        photo_preview: pilot.photo ? `/storage/${pilot.photo}` : null\r\n                    };\r\n                } else {\r\n                    this.$router.push(\'/pilotos\');\r\n                }\r\n            } catch (error) {\r\n                console.error(\'Error loading pilot:\', error);\r\n                this.$router.push(\'/pilotos\');\r\n            } finally {\r\n                this.loading = false;\r\n            }\r\n        },\r\n\r\n        validateRut() {\r\n            if (!this.form.rut) {\r\n                this.rutError = \'El RUT es obligatorio\';\r\n                return false;\r\n            }\r\n            if (!this.isValidRut(this.form.rut)) {\r\n                this.rutError = \'El RUT ingresado no es válido\';\r\n                return false;\r\n            }\r\n            this.rutError = \'\';\r\n            return true;\r\n        },\r\n        isValidRut(rut) {\r\n            // Limpia formato\r\n            rut = rut.replace(/[^0-9kK]/g, \'\').toUpperCase();\r\n            if (rut.length < 8) return false;\r\n            let cuerpo = rut.slice(0, -1);\r\n            let dv = rut.slice(-1);\r\n            let suma = 0, multiplo = 2;\r\n            for (let i = cuerpo.length - 1; i >= 0; i--) {\r\n                suma += parseInt(cuerpo.charAt(i)) * multiplo;\r\n                multiplo = multiplo < 7 ? multiplo + 1 : 2;\r\n            }\r\n            let dvEsperado = 11 - (suma % 11);\r\n            dvEsperado = dvEsperado === 11 ? \'0\' : dvEsperado === 10 ? \'K\' : dvEsperado.toString();\r\n            return dv === dvEsperado;\r\n        },\r\n\r\n        async submitForm() {\r\n            this.loading = true;\r\n            this.errors = {};\r\n            if (!this.validateRut()) {\r\n                this.loading = false;\r\n                return;\r\n            }\r\n\r\n            try {\r\n                const formData = new FormData();\r\n                \r\n                Object.keys(this.form).forEach(key => {\r\n                    if (key !== \'photo_preview\' && this.form[key] !== null && this.form[key] !== \'\') {\r\n                        formData.append(key, this.form[key]);\r\n                    }\r\n                });\r\n\r\n                const url = this.isEdit ? `/api/pilots/${this.pilotId}` : \'/api/pilots\';\r\n                const method = this.isEdit ? \'PUT\' : \'POST\';\r\n\r\n                // Para PUT con FormData, necesitamos usar POST con _method\r\n                if (this.isEdit) {\r\n                    formData.append(\'_method\', \'PUT\');\r\n                }\r\n\r\n                const response = await fetch(url, {\r\n                    method: this.isEdit ? \'POST\' : \'POST\',\r\n                    headers: {\r\n                        \'X-CSRF-TOKEN\': document.querySelector(\'meta[name="csrf-token"]\').getAttribute(\'content\'),\r\n                    },\r\n                    body: formData\r\n                });\r\n\r\n                const data = await response.json();\r\n\r\n                if (response.ok) {\r\n                    console.log(\'PilotForm: Submit successful, isEdit:\', this.isEdit);\r\n                    if (this.isEdit) {\r\n                        // Si es edición, regresar al detalle del piloto con parámetro de éxito\r\n                        const redirectUrl = `/pilotos/${this.pilotId}?updated=true`;\r\n                        console.log(\'PilotForm: Redirecting to:\', redirectUrl);\r\n                        this.$router.push(redirectUrl);\r\n                    } else {\r\n                        // Si es creación, ir a la lista de pilotos\r\n                        console.log(\'PilotForm: Redirecting to pilots list\');\r\n                        this.$router.push(\'/pilotos\');\r\n                        this.showSuccessMessage(\'Piloto creado exitosamente\');\r\n                    }\r\n                } else {\r\n                    if (data.errors) {\r\n                        this.errors = data.errors;\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error(\'Error submitting form:\', error);\r\n            } finally {\r\n                this.loading = false;\r\n            }\r\n        },\r\n\r\n        handleFileUpload(event) {\r\n            const file = event.target.files[0];\r\n            if (file) {\r\n                this.form.photo = file;\r\n                \r\n                // Crear preview\r\n                const reader = new FileReader();\r\n                reader.onload = (e) => {\r\n                    this.form.photo_preview = e.target.result;\r\n                };\r\n                reader.readAsDataURL(file);\r\n            }\r\n        },\r\n\r\n        getStatusClass(status) {\r\n            const classes = {\r\n                \'active\': \'badge badge-success\',\r\n                \'inactive\': \'badge badge-secondary\',\r\n                \'suspended\': \'badge badge-danger\'\r\n            };\r\n            return classes[status] || \'badge badge-secondary\';\r\n        },\r\n\r\n        getStatusLabel(status) {\r\n            const labels = {\r\n                \'active\': \'Activo\',\r\n                \'inactive\': \'Inactivo\',\r\n                \'suspended\': \'Suspendido\'\r\n            };\r\n            return labels[status] || \'Desconocido\';\r\n        },\r\n\r\n        showSuccessMessage(message) {\r\n            // Crear notificación temporal\r\n            const notification = document.createElement(\'div\');\r\n            notification.className = \'alert alert-success alert-dismissible fade show position-fixed\';\r\n            notification.style.cssText = \'top: 20px; right: 20px; z-index: 9999; min-width: 300px;\';\r\n            notification.innerHTML = `\r\n                <i class="fas fa-check-circle mr-2"></i>\r\n                ${message}\r\n                <button type="button" class="close" data-dismiss="alert">\r\n                    <span>&times;</span>\r\n                </button>\r\n            `;\r\n            \r\n            document.body.appendChild(notification);\r\n            \r\n            // Auto-remover después de 4 segundos\r\n            setTimeout(() => {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                }\r\n            }, 4000);\r\n        }\r\n    }\r\n};\r\n<\/script>\r\n\r\n<style scoped>\r\n.pilot-form {\r\n    padding: 0;\r\n}\r\n\r\n.content-header {\r\n    padding: 15px 0;\r\n}\r\n\r\n.card {\r\n    border: none;\r\n    box-shadow: 0 0 1px rgba(0,0,0,.125), 0 1px 3px rgba(0,0,0,.2);\r\n}\r\n\r\n.form-group label {\r\n    font-weight: 600;\r\n}\r\n\r\n.is-invalid {\r\n    border-color: #dc3545;\r\n}\r\n\r\n.invalid-feedback {\r\n    display: block;\r\n}\r\n</style>\r\n'],sourceRoot:""}]);const o=i},4447:(r,t,n)=>{n.r(t),n.d(t,{default:()=>f});function e(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var n=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=n){var e,s,a,i,o=[],l=!0,c=!1;try{if(a=(n=n.call(r)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(e=a.call(n)).done)&&(o.push(e.value),o.length!==t);l=!0);}catch(r){c=!0,s=r}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return o}}(r,t)||function(r,t){if(r){if("string"==typeof r)return s(r,t);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(r,t):void 0}}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(r,t){(null==t||t>r.length)&&(t=r.length);for(var n=0,e=Array(t);n<t;n++)e[n]=r[n];return e}function a(){var r,t,n="function"==typeof Symbol?Symbol:{},e=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function o(n,e,s,a){var o=e&&e.prototype instanceof c?e:c,d=Object.create(o.prototype);return i(d,"_invoke",function(n,e,s){var a,i,o,c=0,d=s||[],u=!1,v={p:0,n:0,v:r,a:m,f:m.bind(r,4),d:function(t,n){return a=t,i=0,o=r,v.n=n,l}};function m(n,e){for(i=n,o=e,t=0;!u&&c&&!s&&t<d.length;t++){var s,a=d[t],m=v.p,f=a[2];n>3?(s=f===e)&&(o=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=r):a[0]<=m&&((s=n<2&&m<a[1])?(i=0,v.v=e,v.n=a[1]):m<f&&(s=n<3||a[0]>e||e>f)&&(a[4]=n,a[5]=e,v.n=f,i=0))}if(s||n>1)return l;throw u=!0,e}return function(s,d,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&m(d,f),i=d,o=f;(t=i<2?r:o)||!u;){a||(i?i<3?(i>1&&(v.n=-1),m(i,o)):v.n=o:v.v=o);try{if(c=2,a){if(i||(s="next"),t=a[s]){if(!(t=t.call(a,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(o=TypeError("The iterator does not provide a '"+s+"' method"),i=1);a=r}else if((t=(u=v.n<0)?o:n.call(e,v))!==l)break}catch(t){a=r,i=1,o=t}finally{c=1}}return{value:t,done:u}}}(n,s,a),!0),d}var l={};function c(){}function d(){}function u(){}t=Object.getPrototypeOf;var v=[][e]?t(t([][e]())):(i(t={},e,function(){return this}),t),m=u.prototype=c.prototype=Object.create(v);function f(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,u):(r.__proto__=u,i(r,s,"GeneratorFunction")),r.prototype=Object.create(m),r}return d.prototype=u,i(m,"constructor",u),i(u,"constructor",d),d.displayName="GeneratorFunction",i(u,s,"GeneratorFunction"),i(m),i(m,s,"Generator"),i(m,e,function(){return this}),i(m,"toString",function(){return"[object Generator]"}),(a=function(){return{w:o,m:f}})()}function i(r,t,n,e){var s=Object.defineProperty;try{s({},"",{})}catch(r){s=0}i=function(r,t,n,e){if(t)s?s(r,t,{value:n,enumerable:!e,configurable:!e,writable:!e}):r[t]=n;else{var a=function(t,n){i(r,t,function(r){return this._invoke(t,n,r)})};a("next",0),a("throw",1),a("return",2)}},i(r,t,n,e)}function o(r,t,n,e,s,a,i){try{var o=r[a](i),l=o.value}catch(r){return void n(r)}o.done?t(l):Promise.resolve(l).then(e,s)}function l(r){return function(){var t=this,n=arguments;return new Promise(function(e,s){var a=r.apply(t,n);function i(r){o(a,e,s,i,l,"next",r)}function l(r){o(a,e,s,i,l,"throw",r)}i(void 0)})}}const c={name:"PilotForm",data:function(){return{loading:!1,clubs:[],form:{first_name:"",last_name:"",rut:"",age:"",status:"active",club_id:"",photo:null,photo_preview:null},errors:{},rutError:""}},computed:{isEdit:function(){return!!this.$route.params.id},pilotId:function(){return this.$route.params.id}},mounted:function(){var r=this;return l(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.loadFormData();case 1:if(!r.isEdit){t.n=2;break}return t.n=2,r.loadPilot();case 2:return t.a(2)}},t)}))()},methods:{loadFormData:function(){var r=this;return l(a().m(function t(){var n,s,i,o,l;return a().w(function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,Promise.all([fetch("/api/clubs")]);case 1:if(n=t.v,s=e(n,1),!(i=s[0]).ok){t.n=3;break}return t.n=2,i.json();case 2:o=t.v,r.clubs=o.data||o;case 3:t.n=5;break;case 4:t.p=4,l=t.v,console.error("Error loading form data:",l);case 5:return t.a(2)}},t,null,[[0,4]])}))()},loadPilot:function(){var r=this;return l(a().m(function t(){var n,e,s,i;return a().w(function(t){for(;;)switch(t.n){case 0:return t.p=0,r.loading=!0,t.n=1,fetch("/api/pilots/".concat(r.pilotId));case 1:if(!(n=t.v).ok){t.n=3;break}return t.n=2,n.json();case 2:e=t.v,s=e.data||e,r.form={first_name:s.first_name||"",last_name:s.last_name||"",age:s.age||"",status:s.status||"active",club_id:s.club_id||"",photo:null,photo_preview:s.photo?"/storage/".concat(s.photo):null},t.n=4;break;case 3:r.$router.push("/pilotos");case 4:t.n=6;break;case 5:t.p=5,i=t.v,console.error("Error loading pilot:",i),r.$router.push("/pilotos");case 6:return t.p=6,r.loading=!1,t.f(6);case 7:return t.a(2)}},t,null,[[0,5,6,7]])}))()},validateRut:function(){return this.form.rut?this.isValidRut(this.form.rut)?(this.rutError="",!0):(this.rutError="El RUT ingresado no es válido",!1):(this.rutError="El RUT es obligatorio",!1)},isValidRut:function(r){if((r=r.replace(/[^0-9kK]/g,"").toUpperCase()).length<8)return!1;for(var t=r.slice(0,-1),n=r.slice(-1),e=0,s=2,a=t.length-1;a>=0;a--)e+=parseInt(t.charAt(a))*s,s=s<7?s+1:2;var i=11-e%11;return n===(i=11===i?"0":10===i?"K":i.toString())},submitForm:function(){var r=this;return l(a().m(function t(){var n,e,s,i,o,l;return a().w(function(t){for(;;)switch(t.n){case 0:if(r.loading=!0,r.errors={},r.validateRut()){t.n=1;break}return r.loading=!1,t.a(2);case 1:return t.p=1,n=new FormData,Object.keys(r.form).forEach(function(t){"photo_preview"!==t&&null!==r.form[t]&&""!==r.form[t]&&n.append(t,r.form[t])}),e=r.isEdit?"/api/pilots/".concat(r.pilotId):"/api/pilots",r.isEdit?"PUT":"POST",r.isEdit&&n.append("_method","PUT"),t.n=2,fetch(e,{method:(r.isEdit,"POST"),headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:n});case 2:return s=t.v,t.n=3,s.json();case 3:i=t.v,s.ok?(console.log("PilotForm: Submit successful, isEdit:",r.isEdit),r.isEdit?(o="/pilotos/".concat(r.pilotId,"?updated=true"),console.log("PilotForm: Redirecting to:",o),r.$router.push(o)):(console.log("PilotForm: Redirecting to pilots list"),r.$router.push("/pilotos"),r.showSuccessMessage("Piloto creado exitosamente"))):i.errors&&(r.errors=i.errors),t.n=5;break;case 4:t.p=4,l=t.v,console.error("Error submitting form:",l);case 5:return t.p=5,r.loading=!1,t.f(5);case 6:return t.a(2)}},t,null,[[1,4,5,6]])}))()},handleFileUpload:function(r){var t=this,n=r.target.files[0];if(n){this.form.photo=n;var e=new FileReader;e.onload=function(r){t.form.photo_preview=r.target.result},e.readAsDataURL(n)}},getStatusClass:function(r){return{active:"badge badge-success",inactive:"badge badge-secondary",suspended:"badge badge-danger"}[r]||"badge badge-secondary"},getStatusLabel:function(r){return{active:"Activo",inactive:"Inactivo",suspended:"Suspendido"}[r]||"Desconocido"},showSuccessMessage:function(r){var t=document.createElement("div");t.className="alert alert-success alert-dismissible fade show position-fixed",t.style.cssText="top: 20px; right: 20px; z-index: 9999; min-width: 300px;",t.innerHTML='\n                <i class="fas fa-check-circle mr-2"></i>\n                '.concat(r,'\n                <button type="button" class="close" data-dismiss="alert">\n                    <span>&times;</span>\n                </button>\n            '),document.body.appendChild(t),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},4e3)}}};var d=n(5072),u=n.n(d),v=n(4409),m={insert:"head",singleton:!1};u()(v.A,m);v.A.locals;const f=(0,n(4486).A)(c,function(){var r=this,t=r._self._c;return t("div",{staticClass:"pilot-form"},[t("div",{staticClass:"content-header"},[t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"row mb-2"},[t("div",{staticClass:"col-sm-6"},[t("h1",{staticClass:"m-0"},[t("i",{staticClass:"fas fa-user-ninja mr-2"}),r._v("\n                        "+r._s(r.isEdit?"Editar":"Crear")+" Piloto\n                    ")])]),r._v(" "),t("div",{staticClass:"col-sm-6"},[t("ol",{staticClass:"breadcrumb float-sm-right"},[t("li",{staticClass:"breadcrumb-item"},[t("router-link",{attrs:{to:"/"}},[r._v("Inicio")])],1),r._v(" "),t("li",{staticClass:"breadcrumb-item"},[t("router-link",{attrs:{to:"/pilotos"}},[r._v("Pilotos")])],1),r._v(" "),t("li",{staticClass:"breadcrumb-item active"},[r._v("\n                            "+r._s(r.isEdit?"Editar":"Crear")+"\n                        ")])])])])])]),r._v(" "),t("section",{staticClass:"content"},[t("div",{staticClass:"container-fluid"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-8"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("h3",{staticClass:"card-title"},[r._v("\n                                "+r._s(r.isEdit?"Editar":"Nuevo")+" Piloto\n                            ")])]),r._v(" "),t("form",{staticClass:"card-body",on:{submit:function(t){return t.preventDefault(),r.submitForm.apply(null,arguments)}}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"first_name"}},[r._v("Nombre *")]),r._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:r.form.first_name,expression:"form.first_name"}],staticClass:"form-control",class:{"is-invalid":r.errors.first_name},attrs:{type:"text",id:"first_name",required:""},domProps:{value:r.form.first_name},on:{input:function(t){t.target.composing||r.$set(r.form,"first_name",t.target.value)}}}),r._v(" "),r.errors.first_name?t("div",{staticClass:"invalid-feedback"},[r._v("\n                                            "+r._s(r.errors.first_name[0])+"\n                                        ")]):r._e()])]),r._v(" "),t("div",{staticClass:"col-md-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"last_name"}},[r._v("Apellidos *")]),r._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:r.form.last_name,expression:"form.last_name"}],staticClass:"form-control",class:{"is-invalid":r.errors.last_name},attrs:{type:"text",id:"last_name",required:""},domProps:{value:r.form.last_name},on:{input:function(t){t.target.composing||r.$set(r.form,"last_name",t.target.value)}}}),r._v(" "),r.errors.last_name?t("div",{staticClass:"invalid-feedback"},[r._v("\n                                            "+r._s(r.errors.last_name[0])+"\n                                        ")]):r._e()])])]),r._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"rut"}},[r._v("RUT *")]),r._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:r.form.rut,expression:"form.rut"}],staticClass:"form-control",class:{"is-invalid":r.errors.rut||r.rutError},attrs:{type:"text",id:"rut",required:"",placeholder:"Ej: 12.345.678-9"},domProps:{value:r.form.rut},on:{blur:r.validateRut,input:function(t){t.target.composing||r.$set(r.form,"rut",t.target.value)}}}),r._v(" "),r.errors.rut?t("div",{staticClass:"invalid-feedback"},[r._v("\n                                            "+r._s(r.errors.rut[0])+"\n                                        ")]):r.rutError?t("div",{staticClass:"invalid-feedback"},[r._v("\n                                            "+r._s(r.rutError)+"\n                                        ")]):r._e()])]),r._v(" "),t("div",{staticClass:"col-md-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"age"}},[r._v("Edad")]),r._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:r.form.age,expression:"form.age"}],staticClass:"form-control",class:{"is-invalid":r.errors.age},attrs:{type:"number",id:"age"},domProps:{value:r.form.age},on:{input:function(t){t.target.composing||r.$set(r.form,"age",t.target.value)}}}),r._v(" "),r.errors.age?t("div",{staticClass:"invalid-feedback"},[r._v("\n                                            "+r._s(r.errors.age[0])+"\n                                        ")]):r._e()])])]),r._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"status"}},[r._v("Estado")]),r._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.form.status,expression:"form.status"}],staticClass:"form-control",class:{"is-invalid":r.errors.status},attrs:{id:"status"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(r){return r.selected}).map(function(r){return"_value"in r?r._value:r.value});r.$set(r.form,"status",t.target.multiple?n:n[0])}}},[t("option",{attrs:{value:"active"}},[r._v("Activo")]),r._v(" "),t("option",{attrs:{value:"inactive"}},[r._v("Inactivo")]),r._v(" "),t("option",{attrs:{value:"suspended"}},[r._v("Suspendido")])]),r._v(" "),r.errors.status?t("div",{staticClass:"invalid-feedback"},[r._v("\n                                            "+r._s(r.errors.status[0])+"\n                                        ")]):r._e()])]),r._v(" "),t("div",{staticClass:"col-md-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"club_id"}},[r._v("Club")]),r._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:r.form.club_id,expression:"form.club_id"}],staticClass:"form-control",class:{"is-invalid":r.errors.club_id},attrs:{id:"club_id"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(r){return r.selected}).map(function(r){return"_value"in r?r._value:r.value});r.$set(r.form,"club_id",t.target.multiple?n:n[0])}}},[t("option",{attrs:{value:""}},[r._v("Seleccionar club...")]),r._v(" "),r._l(r.clubs,function(n){return t("option",{key:n.id,domProps:{value:n.id}},[r._v("\n                                                "+r._s(n.name)+"\n                                            ")])})],2),r._v(" "),r.errors.club_id?t("div",{staticClass:"invalid-feedback"},[r._v("\n                                            "+r._s(r.errors.club_id[0])+"\n                                        ")]):r._e()])])]),r._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"photo"}},[r._v("Foto del Piloto")]),r._v(" "),t("input",{staticClass:"form-control-file",attrs:{type:"file",id:"photo",accept:"image/*"},on:{change:r.handleFileUpload}}),r._v(" "),t("small",{staticClass:"form-text text-muted"},[r._v("\n                                    Formatos permitidos: JPG, PNG, GIF. Tamaño máximo: 2MB\n                                ")])]),r._v(" "),t("div",{staticClass:"form-group"},[t("div",{staticClass:"d-flex justify-content-between"},[t("router-link",{staticClass:"btn btn-secondary",attrs:{to:"/pilotos"}},[t("i",{staticClass:"fas fa-arrow-left mr-1"}),r._v("\n                                        Volver\n                                    ")]),r._v(" "),t("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:r.loading}},[r.loading?t("i",{staticClass:"fas fa-spinner fa-spin mr-1"}):t("i",{staticClass:"fas fa-save mr-1"}),r._v("\n                                        "+r._s(r.isEdit?"Actualizar":"Crear")+" Piloto\n                                    ")])],1)])])])]),r._v(" "),t("div",{staticClass:"col-md-4"},[t("div",{staticClass:"card"},[r._m(0),r._v(" "),t("div",{staticClass:"card-body text-center"},[t("div",{staticClass:"mb-3"},[r.form.photo_preview?t("img",{staticClass:"img-fluid rounded-circle",staticStyle:{width:"120px",height:"120px","object-fit":"cover"},attrs:{src:r.form.photo_preview,alt:"Vista previa"}}):t("div",{staticClass:"bg-secondary rounded-circle d-inline-flex align-items-center justify-content-center",staticStyle:{width:"120px",height:"120px"}},[t("i",{staticClass:"fas fa-user fa-3x text-white"})])]),r._v(" "),t("h4",[r._v(r._s(r.form.first_name||"Nombre")+" "+r._s(r.form.last_name||"Apellidos"))]),r._v(" "),t("p",{staticClass:"text-muted"},[r._v("Edad: "+r._s(r.form.age||"No especificada"))]),r._v(" "),t("span",{class:r.getStatusClass(r.form.status)},[r._v("\n                                "+r._s(r.getStatusLabel(r.form.status))+"\n                            ")])])])])])])])])},[function(){var r=this._self._c;return r("div",{staticClass:"card-header"},[r("h3",{staticClass:"card-title"},[this._v("Vista Previa")])])}],!1,null,"1428465c",null).exports}}]);
//# sourceMappingURL=447.js.map